<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Mnist Viewer: Network Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Mnist Viewer
   &#160;<span id="projectnumber">0.5.0.0</span>
   </div>
   <div id="projectbrief">A simple GUI to interact with the MNIST data set.</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('class_network.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-slots">Public Slots</a> &#124;
<a href="#signals">Signals</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="class_network-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">Network Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>The backend class that handles data flow into and out of the network.  
 <a href="class_network.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="network_8h_source.html">network.h</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for Network:</div>
<div class="dyncontent">
 <div class="center">
  <img src="class_network.png" alt=""/>
 </div></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-slots"></a>
Public Slots</h2></td></tr>
<tr class="memitem:adeeef709062e797fcf1a0e6d8cd18810"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_network.html#adeeef709062e797fcf1a0e6d8cd18810">changeImage</a> (int increment)</td></tr>
<tr class="memdesc:adeeef709062e797fcf1a0e6d8cd18810"><td class="mdescLeft">&#160;</td><td class="mdescRight">The slot that records when a new image should be predicted and displayed.  <a href="class_network.html#adeeef709062e797fcf1a0e6d8cd18810">More...</a><br /></td></tr>
<tr class="separator:adeeef709062e797fcf1a0e6d8cd18810"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae713382eb8476d14c48028e1582365ff"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_network.html#ae713382eb8476d14c48028e1582365ff">startTraining</a> (unsigned int batch_size, unsigned int epochs)</td></tr>
<tr class="memdesc:ae713382eb8476d14c48028e1582365ff"><td class="mdescLeft">&#160;</td><td class="mdescRight">The slot that requests to train the network on training data.  <a href="class_network.html#ae713382eb8476d14c48028e1582365ff">More...</a><br /></td></tr>
<tr class="separator:ae713382eb8476d14c48028e1582365ff"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="signals"></a>
Signals</h2></td></tr>
<tr class="memitem:a92f5ba4b117136d3c821b94bb556f7cc"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_network.html#a92f5ba4b117136d3c821b94bb556f7cc">example</a> (int index, QImage image, int truth, int prediction)</td></tr>
<tr class="memdesc:a92f5ba4b117136d3c821b94bb556f7cc"><td class="mdescLeft">&#160;</td><td class="mdescRight">A signal containing a new example and associated labels.  <a href="class_network.html#a92f5ba4b117136d3c821b94bb556f7cc">More...</a><br /></td></tr>
<tr class="separator:a92f5ba4b117136d3c821b94bb556f7cc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab8977e4e88c259ebf57040c0f16a7b36"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_network.html#ab8977e4e88c259ebf57040c0f16a7b36">trainingUpdate</a> (unsigned int batch, unsigned int total_batches, unsigned int epoch, unsigned int total_epochs, float latest_loss)</td></tr>
<tr class="memdesc:ab8977e4e88c259ebf57040c0f16a7b36"><td class="mdescLeft">&#160;</td><td class="mdescRight">A signal that periodically emits to showcase training progress.  <a href="class_network.html#ab8977e4e88c259ebf57040c0f16a7b36">More...</a><br /></td></tr>
<tr class="separator:ab8977e4e88c259ebf57040c0f16a7b36"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a0b2a0282570fcc47174e80030d0672e9"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_network.html#a0b2a0282570fcc47174e80030d0672e9">Network</a> (QObject *parent=nullptr)</td></tr>
<tr class="memdesc:a0b2a0282570fcc47174e80030d0672e9"><td class="mdescLeft">&#160;</td><td class="mdescRight">The default constructor.  <a href="class_network.html#a0b2a0282570fcc47174e80030d0672e9">More...</a><br /></td></tr>
<tr class="separator:a0b2a0282570fcc47174e80030d0672e9"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr class="memitem:a918e8764ff7d1ec1075b4d7c03cbc637"><td class="memItemLeft" align="right" valign="top">QImage&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_network.html#a918e8764ff7d1ec1075b4d7c03cbc637">convertToImage</a> (torch::Tensor tensor)</td></tr>
<tr class="memdesc:a918e8764ff7d1ec1075b4d7c03cbc637"><td class="mdescLeft">&#160;</td><td class="mdescRight">Takes a Tensor and converts it into a QImage.  <a href="class_network.html#a918e8764ff7d1ec1075b4d7c03cbc637">More...</a><br /></td></tr>
<tr class="separator:a918e8764ff7d1ec1075b4d7c03cbc637"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae438d2367e76e8367ea63cf40a654006"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_network.html#ae438d2367e76e8367ea63cf40a654006">sendImage</a> ()</td></tr>
<tr class="memdesc:ae438d2367e76e8367ea63cf40a654006"><td class="mdescLeft">&#160;</td><td class="mdescRight">The method to predict the image and output a <a class="el" href="class_network.html#a92f5ba4b117136d3c821b94bb556f7cc">example</a> signal.  <a href="class_network.html#ae438d2367e76e8367ea63cf40a654006">More...</a><br /></td></tr>
<tr class="separator:ae438d2367e76e8367ea63cf40a654006"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:a4c8dddada64d75c5da4df8f056124f81"><td class="memItemLeft" align="right" valign="top">size_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_network.html#a4c8dddada64d75c5da4df8f056124f81">current_index</a></td></tr>
<tr class="memdesc:a4c8dddada64d75c5da4df8f056124f81"><td class="mdescLeft">&#160;</td><td class="mdescRight">The index of the current image that should be displayed.  <a href="class_network.html#a4c8dddada64d75c5da4df8f056124f81">More...</a><br /></td></tr>
<tr class="separator:a4c8dddada64d75c5da4df8f056124f81"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0b8cef53ecb3c0d57e325e3295c35130"><td class="memItemLeft" align="right" valign="top">QScopedPointer&lt; torch::data::datasets::MNIST &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_network.html#a0b8cef53ecb3c0d57e325e3295c35130">data</a></td></tr>
<tr class="memdesc:a0b8cef53ecb3c0d57e325e3295c35130"><td class="mdescLeft">&#160;</td><td class="mdescRight">A pointer to the loaded dataset.  <a href="class_network.html#a0b8cef53ecb3c0d57e325e3295c35130">More...</a><br /></td></tr>
<tr class="separator:a0b8cef53ecb3c0d57e325e3295c35130"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abac93a2549bd645b36a20c1759ba3b2f"><td class="memItemLeft" align="right" valign="top">const QString&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_network.html#abac93a2549bd645b36a20c1759ba3b2f">DATA_PATH</a> = &quot;C:/Users/kylem/Documents/dev/src/mnist-viewer/<a class="el" href="class_network.html#a0b8cef53ecb3c0d57e325e3295c35130">data</a>&quot;</td></tr>
<tr class="memdesc:abac93a2549bd645b36a20c1759ba3b2f"><td class="mdescLeft">&#160;</td><td class="mdescRight">The hard coded location of the dataset file.  <a href="class_network.html#abac93a2549bd645b36a20c1759ba3b2f">More...</a><br /></td></tr>
<tr class="separator:abac93a2549bd645b36a20c1759ba3b2f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad8dd3209c836d387f5e6c762b8e7f476"><td class="memItemLeft" align="right" valign="top">torch::nn::Sequential&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_network.html#ad8dd3209c836d387f5e6c762b8e7f476">network</a></td></tr>
<tr class="memdesc:ad8dd3209c836d387f5e6c762b8e7f476"><td class="mdescLeft">&#160;</td><td class="mdescRight">The MNIST network that does the prediction.  <a href="class_network.html#ad8dd3209c836d387f5e6c762b8e7f476">More...</a><br /></td></tr>
<tr class="separator:ad8dd3209c836d387f5e6c762b8e7f476"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>The backend class that handles data flow into and out of the network. </p>
<p>This class not only defines the network. It also sets up the slots and signals to receive and send out data to it. It will perform all the right type conversions to extract images, labels, and predictions from the example set.</p>
<p>In particular, the <a class="el" href="class_network.html#ad8dd3209c836d387f5e6c762b8e7f476">network</a> has the following shape: </p><table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Layer Type   </th><th class="markdownTableHeadNone">Details    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">2D Convolution   </td><td class="markdownTableBodyNone">32 3x3 Filters    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">ReLU Activation   </td><td class="markdownTableBodyNone">None    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">2D Max Pool   </td><td class="markdownTableBodyNone">2x2 Filter    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">2D Convolution   </td><td class="markdownTableBodyNone">2 3x3 Filters    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">ReLU Activation   </td><td class="markdownTableBodyNone">None    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">2D Max Pool   </td><td class="markdownTableBodyNone">2x2 Filter    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">2D Convolution   </td><td class="markdownTableBodyNone">1 3x3 Filter    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">ReLU Activation   </td><td class="markdownTableBodyNone">None    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Flatten   </td><td class="markdownTableBodyNone">None    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">Full Layer   </td><td class="markdownTableBodyNone">576 x 64    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">ReLU Activation   </td><td class="markdownTableBodyNone">None    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone">Full Layer   </td><td class="markdownTableBodyNone">64 x 10    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone">Softmax Activation   </td><td class="markdownTableBodyNone">None   </td></tr>
</table>

<p class="definition">Definition at line <a class="el" href="network_8h_source.html#l00042">42</a> of file <a class="el" href="network_8h_source.html">network.h</a>.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a0b2a0282570fcc47174e80030d0672e9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0b2a0282570fcc47174e80030d0672e9">&#9670;&nbsp;</a></span>Network()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">Network::Network </td>
          <td>(</td>
          <td class="paramtype">QObject *&#160;</td>
          <td class="paramname"><em>parent</em> = <code>nullptr</code></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">explicit</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The default constructor. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">parent</td><td>A parent QObject class, as is usual for any class that inherits it. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="network_8cpp_source.html#l00005">5</a> of file <a class="el" href="network_8cpp_source.html">network.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;                                 :</div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;        QObject(parent),</div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160; </div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;        <a class="code" href="class_network.html#ad8dd3209c836d387f5e6c762b8e7f476">network</a>(</div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;                torch::nn::Conv2d(torch::nn::Conv2dOptions(1, 32, 3)),</div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;                torch::nn::ReLU(torch::nn::ReLUOptions()),</div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;                torch::nn::MaxPool2d(torch::nn::MaxPool2dOptions(2)),</div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160; </div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;                torch::nn::Conv2d(torch::nn::Conv2dOptions(32, 64, 3)),</div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;                torch::nn::ReLU(torch::nn::ReLUOptions()),</div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;                torch::nn::MaxPool2d(torch::nn::MaxPool2dOptions(2)),</div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160; </div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;                torch::nn::Conv2d(torch::nn::Conv2dOptions(64, 64, 3)),</div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;                torch::nn::ReLU(torch::nn::ReLUOptions()),</div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160; </div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;                torch::nn::Flatten(torch::nn::FlattenOptions()),</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160; </div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;                torch::nn::Linear(torch::nn::LinearOptions(576, 64)),</div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;                torch::nn::ReLU(torch::nn::ReLU()),</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160; </div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;                torch::nn::Linear(torch::nn::LinearOptions(64, 10)),</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;                torch::nn::LogSoftmax(torch::nn::LogSoftmaxOptions(1))) {</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;    <a class="code" href="class_network.html#ad8dd3209c836d387f5e6c762b8e7f476">network</a>-&gt;train(<span class="keyword">false</span>);</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;    <a class="code" href="class_network.html#a0b8cef53ecb3c0d57e325e3295c35130">data</a>.reset(<span class="keyword">new</span> torch::data::datasets::MNIST(<a class="code" href="class_network.html#abac93a2549bd645b36a20c1759ba3b2f">DATA_PATH</a>.toStdString(), torch::data::datasets::MNIST::Mode::kTest));</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;    <a class="code" href="class_network.html#a4c8dddada64d75c5da4df8f056124f81">current_index</a> = 0;</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;    <a class="code" href="class_network.html#ae438d2367e76e8367ea63cf40a654006">sendImage</a>();</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;}</div>
<div class="ttc" id="aclass_network_html_a0b8cef53ecb3c0d57e325e3295c35130"><div class="ttname"><a href="class_network.html#a0b8cef53ecb3c0d57e325e3295c35130">Network::data</a></div><div class="ttdeci">QScopedPointer&lt; torch::data::datasets::MNIST &gt; data</div><div class="ttdoc">A pointer to the loaded dataset.</div><div class="ttdef"><b>Definition:</b> <a href="network_8h_source.html#l00104">network.h:104</a></div></div>
<div class="ttc" id="aclass_network_html_a4c8dddada64d75c5da4df8f056124f81"><div class="ttname"><a href="class_network.html#a4c8dddada64d75c5da4df8f056124f81">Network::current_index</a></div><div class="ttdeci">size_t current_index</div><div class="ttdoc">The index of the current image that should be displayed.</div><div class="ttdef"><b>Definition:</b> <a href="network_8h_source.html#l00100">network.h:100</a></div></div>
<div class="ttc" id="aclass_network_html_abac93a2549bd645b36a20c1759ba3b2f"><div class="ttname"><a href="class_network.html#abac93a2549bd645b36a20c1759ba3b2f">Network::DATA_PATH</a></div><div class="ttdeci">const QString DATA_PATH</div><div class="ttdoc">The hard coded location of the dataset file.</div><div class="ttdef"><b>Definition:</b> <a href="network_8h_source.html#l00108">network.h:108</a></div></div>
<div class="ttc" id="aclass_network_html_ad8dd3209c836d387f5e6c762b8e7f476"><div class="ttname"><a href="class_network.html#ad8dd3209c836d387f5e6c762b8e7f476">Network::network</a></div><div class="ttdeci">torch::nn::Sequential network</div><div class="ttdoc">The MNIST network that does the prediction.</div><div class="ttdef"><b>Definition:</b> <a href="network_8h_source.html#l00112">network.h:112</a></div></div>
<div class="ttc" id="aclass_network_html_ae438d2367e76e8367ea63cf40a654006"><div class="ttname"><a href="class_network.html#ae438d2367e76e8367ea63cf40a654006">Network::sendImage</a></div><div class="ttdeci">void sendImage()</div><div class="ttdoc">The method to predict the image and output a example signal.</div><div class="ttdef"><b>Definition:</b> <a href="network_8cpp_source.html#l00108">network.cpp:108</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="network_8h_source.html#l00100">current_index</a>, <a class="el" href="network_8h_source.html#l00104">data</a>, <a class="el" href="network_8h_source.html#l00108">DATA_PATH</a>, <a class="el" href="network_8h_source.html#l00112">network</a>, and <a class="el" href="network_8cpp_source.html#l00108">sendImage()</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="adeeef709062e797fcf1a0e6d8cd18810"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adeeef709062e797fcf1a0e6d8cd18810">&#9670;&nbsp;</a></span>changeImage</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Network::changeImage </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>increment</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">slot</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The slot that records when a new image should be predicted and displayed. </p>
<p>This will update all the internal indices and ultimate result in a new <a class="el" href="class_network.html#a92f5ba4b117136d3c821b94bb556f7cc">example</a> signal to be emitted. If the end of the dataset has been reached, it will wrap around to the start. Likewise for traveling backwards. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">increment</td><td>The number of places to offset when selecting the new image. For instance, a value of 1 will change the image from index <em>N</em> to index <em>N+1</em>. If zero is sent, a new prediction is still made and an image emitted. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="network_8cpp_source.html#l00033">33</a> of file <a class="el" href="network_8cpp_source.html">network.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;                                       {</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;    <span class="comment">// To avoid overflow, this uses a series of while loops to bring the</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;    <span class="comment">// requested increment into the range of data values. The assumption</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;    <span class="comment">// is that the data size won&#39;t approach the max value of int.</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;    <span class="comment">// There are probably ways to do this better, but I was having</span></div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;    <span class="comment">// difficulty with handling negative increments.</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;    <span class="keywordtype">size_t</span> data_size = <a class="code" href="class_network.html#a0b8cef53ecb3c0d57e325e3295c35130">data</a>-&gt;size().value();</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    <span class="keywordflow">while</span> (increment &lt; 0) {</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;        increment += data_size;</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;    }</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;    <span class="keywordflow">while</span> (increment &gt;= data_size) {</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;        increment -= data_size;</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    }</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;    <a class="code" href="class_network.html#a4c8dddada64d75c5da4df8f056124f81">current_index</a> += increment;</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;    <span class="keywordflow">while</span> (<a class="code" href="class_network.html#a4c8dddada64d75c5da4df8f056124f81">current_index</a> &gt;= data_size) {</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;        <a class="code" href="class_network.html#a4c8dddada64d75c5da4df8f056124f81">current_index</a> -= data_size;</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    }</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;    <a class="code" href="class_network.html#ae438d2367e76e8367ea63cf40a654006">sendImage</a>();</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="network_8h_source.html#l00100">current_index</a>, <a class="el" href="network_8h_source.html#l00104">data</a>, and <a class="el" href="network_8cpp_source.html#l00108">sendImage()</a>.</p>

<p class="reference">Referenced by <a class="el" href="test__network_8cpp_source.html#l00112">TestNetwork::cycleImage()</a>, and <a class="el" href="main_8cpp_source.html#l00015">main()</a>.</p>

</div>
</div>
<a id="a918e8764ff7d1ec1075b4d7c03cbc637"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a918e8764ff7d1ec1075b4d7c03cbc637">&#9670;&nbsp;</a></span>convertToImage()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">QImage Network::convertToImage </td>
          <td>(</td>
          <td class="paramtype">torch::Tensor&#160;</td>
          <td class="paramname"><em>tensor</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Takes a Tensor and converts it into a QImage. </p>
<p>This currently assumes this will be a 28x28 pixel image. It flattens the tensor and then fills in the QImage. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">tensor</td><td>The input tensor, assumed to have the dimensions of 28x28. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>The resulting image. It is 28x28 and 8-bit grayscale. The image is copied from the tensor, so there is no issue with implicit sharing. </dd></dl>

<p class="definition">Definition at line <a class="el" href="network_8cpp_source.html#l00092">92</a> of file <a class="el" href="network_8cpp_source.html">network.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;                                              {</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    torch::Tensor flat_tensor = tensor.flatten();</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    <span class="keywordtype">float</span> * raw_data = flat_tensor.data&lt;<span class="keywordtype">float</span>&gt;();</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    int64_t pixel_count = flat_tensor.size(0);</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    uchar * pixel_values = <span class="keyword">new</span> uchar[pixel_count];</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; pixel_count; ++i) {</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;        <span class="keywordtype">float</span> pixel_float_value = raw_data[i] * 255.0;</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;        uchar pixel_value = <span class="keyword">static_cast&lt;</span>uchar<span class="keyword">&gt;</span>(qRound(pixel_float_value));</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;        pixel_value = qBound(uchar(0), pixel_value, uchar(255));</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;        <span class="comment">// Invert the color.</span></div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;        pixel_values[i] = 255 - pixel_value;</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    }</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    QImage image(pixel_values, 28, 28, QImage::Format_Grayscale8);</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    <span class="keywordflow">return</span> image.copy();</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;}</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="network_8cpp_source.html#l00108">sendImage()</a>.</p>

</div>
</div>
<a id="a92f5ba4b117136d3c821b94bb556f7cc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a92f5ba4b117136d3c821b94bb556f7cc">&#9670;&nbsp;</a></span>example</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Network::example </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">QImage&#160;</td>
          <td class="paramname"><em>image</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>truth</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>prediction</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">signal</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>A signal containing a new example and associated labels. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">index</td><td>The index number where this example can be found in the dataset. </td></tr>
    <tr><td class="paramname">image</td><td>The image itself. </td></tr>
    <tr><td class="paramname">truth</td><td>The actual label from the dataset. </td></tr>
    <tr><td class="paramname">prediction</td><td>The predicted label from <a class="el" href="class_network.html#ad8dd3209c836d387f5e6c762b8e7f476">network</a>. </td></tr>
  </table>
  </dd>
</dl>

<p class="reference">Referenced by <a class="el" href="main_8cpp_source.html#l00015">main()</a>, and <a class="el" href="network_8cpp_source.html#l00108">sendImage()</a>.</p>

</div>
</div>
<a id="ae438d2367e76e8367ea63cf40a654006"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae438d2367e76e8367ea63cf40a654006">&#9670;&nbsp;</a></span>sendImage()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Network::sendImage </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The method to predict the image and output a <a class="el" href="class_network.html#a92f5ba4b117136d3c821b94bb556f7cc">example</a> signal. </p>
<p>This loads the image at index value <a class="el" href="class_network.html#a4c8dddada64d75c5da4df8f056124f81">current_index</a>, then uses <a class="el" href="class_network.html#ad8dd3209c836d387f5e6c762b8e7f476">network</a> to make a prediction about the data. It also calls <a class="el" href="class_network.html#a918e8764ff7d1ec1075b4d7c03cbc637">convertToImage</a> to create a QImage. All this information is then sent out on the signal. </p>

<p class="definition">Definition at line <a class="el" href="network_8cpp_source.html#l00108">108</a> of file <a class="el" href="network_8cpp_source.html">network.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;                        {</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    <span class="comment">// Get whichever iteration is requested.</span></div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    torch::data::Example&lt;torch::Tensor, torch::Tensor&gt; current_example = <a class="code" href="class_network.html#a0b8cef53ecb3c0d57e325e3295c35130">data</a>-&gt;get(<a class="code" href="class_network.html#a4c8dddada64d75c5da4df8f056124f81">current_index</a>);</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    <span class="comment">// The inputs to the network have to be of the shape {batch_size, channels, width, height}</span></div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    <span class="comment">// so add an additional dimension into the tensor.</span></div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    torch::Tensor input = current_example.data.unsqueeze(0);</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    torch::Tensor prediction_distribution = <a class="code" href="class_network.html#ad8dd3209c836d387f5e6c762b8e7f476">network</a>-&gt;forward(input);</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    <span class="comment">// Whichever index has the max value is the predicted value.</span></div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    <span class="keywordtype">int</span> prediction = prediction_distribution.argmax(1).item&lt;<span class="keywordtype">int</span>&gt;();</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    QImage image = <a class="code" href="class_network.html#a918e8764ff7d1ec1075b4d7c03cbc637">convertToImage</a>(current_example.data);</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    <span class="keywordtype">int</span> label = current_example.target.item&lt;<span class="keywordtype">int</span>&gt;();</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    emit <a class="code" href="class_network.html#a92f5ba4b117136d3c821b94bb556f7cc">example</a>(<a class="code" href="class_network.html#a4c8dddada64d75c5da4df8f056124f81">current_index</a>, image, label, prediction);</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;}</div>
<div class="ttc" id="aclass_network_html_a918e8764ff7d1ec1075b4d7c03cbc637"><div class="ttname"><a href="class_network.html#a918e8764ff7d1ec1075b4d7c03cbc637">Network::convertToImage</a></div><div class="ttdeci">QImage convertToImage(torch::Tensor tensor)</div><div class="ttdoc">Takes a Tensor and converts it into a QImage.</div><div class="ttdef"><b>Definition:</b> <a href="network_8cpp_source.html#l00092">network.cpp:92</a></div></div>
<div class="ttc" id="aclass_network_html_a92f5ba4b117136d3c821b94bb556f7cc"><div class="ttname"><a href="class_network.html#a92f5ba4b117136d3c821b94bb556f7cc">Network::example</a></div><div class="ttdeci">void example(int index, QImage image, int truth, int prediction)</div><div class="ttdoc">A signal containing a new example and associated labels.</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="network_8cpp_source.html#l00092">convertToImage()</a>, <a class="el" href="network_8h_source.html#l00100">current_index</a>, <a class="el" href="network_8h_source.html#l00104">data</a>, <a class="el" href="class_network.html#a92f5ba4b117136d3c821b94bb556f7cc">example()</a>, and <a class="el" href="network_8h_source.html#l00112">network</a>.</p>

<p class="reference">Referenced by <a class="el" href="network_8cpp_source.html#l00033">changeImage()</a>, and <a class="el" href="network_8cpp_source.html#l00005">Network()</a>.</p>

</div>
</div>
<a id="ae713382eb8476d14c48028e1582365ff"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae713382eb8476d14c48028e1582365ff">&#9670;&nbsp;</a></span>startTraining</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Network::startTraining </td>
          <td>(</td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>batch_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>epochs</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">slot</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The slot that requests to train the network on training data. </p>
<p>This will cause the network to run some training. It will create a DataLoader for the dataset, establish optimization and loss functions, then run for the requested number of epochs. During this time, progress will be output using the <a class="el" href="class_network.html#ab8977e4e88c259ebf57040c0f16a7b36">trainingUpdate</a> signal. Completion will also be signalled using the same means. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">batch_size</td><td>How many datapoints to include in each iteration. If this is larger than the dataset, it is assumed to be the dataset. </td></tr>
    <tr><td class="paramname">epochs</td><td>The number of epochs to run for. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="network_8cpp_source.html#l00053">53</a> of file <a class="el" href="network_8cpp_source.html">network.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;                                                                        {</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    <span class="comment">// No need to do anything if either value is zero.</span></div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    <span class="keywordflow">if</span> (batch_size == 0 || epochs == 0) {</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;        emit <a class="code" href="class_network.html#ab8977e4e88c259ebf57040c0f16a7b36">trainingUpdate</a>(1, 1, epochs, epochs, 0.0);</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;        <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    }</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    <a class="code" href="class_network.html#ad8dd3209c836d387f5e6c762b8e7f476">network</a>-&gt;train(<span class="keyword">true</span>);</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    <span class="comment">// This will be a little hacky in that it opens up the dataset seperate from</span></div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    <span class="comment">// the one done at object instantiation. This is to swap the mode.</span></div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    <span class="keyword">auto</span> train_data = torch::data::datasets::MNIST(<a class="code" href="class_network.html#abac93a2549bd645b36a20c1759ba3b2f">DATA_PATH</a>.toStdString(), torch::data::datasets::MNIST::Mode::kTrain).map(torch::data::transforms::Stack&lt;&gt;());</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    <span class="comment">// Estimate about how many batches will be run each epoch.</span></div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    uint batches = qCeil(train_data.size().value() / <span class="keyword">static_cast&lt;</span><span class="keywordtype">double</span><span class="keyword">&gt;</span>(batch_size));</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    torch::data::DataLoaderOptions options;</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    options.batch_size(batch_size);</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    options.workers(2);</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    <span class="keyword">auto</span> data_loader = torch::data::make_data_loader(std::move(train_data), options);</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    <span class="comment">// Create the optimizer functions</span></div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    torch::optim::RMSprop optimizer(<a class="code" href="class_network.html#ad8dd3209c836d387f5e6c762b8e7f476">network</a>-&gt;parameters(), torch::optim::RMSpropOptions());</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    <span class="comment">// Do the training</span></div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    <span class="keywordflow">for</span> (int64_t epoch = 1; epoch &lt;= epochs; ++epoch) {</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;        torch::Tensor loss;</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;        uint batch_index = 1;</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;        <span class="keywordflow">for</span> (torch::data::Example&lt;&gt; &amp; batch : *data_loader) {</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;            <a class="code" href="class_network.html#ad8dd3209c836d387f5e6c762b8e7f476">network</a>-&gt;zero_grad();</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;            torch::Tensor images = batch.data;</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;            torch::Tensor labels = batch.target;</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;            torch::Tensor predictions = <a class="code" href="class_network.html#ad8dd3209c836d387f5e6c762b8e7f476">network</a>-&gt;forward(images);</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;            loss = torch::nll_loss(predictions, labels);</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;            loss.backward();</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;            optimizer.step();</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;            emit <a class="code" href="class_network.html#ab8977e4e88c259ebf57040c0f16a7b36">trainingUpdate</a>(batch_index, batches, <span class="keyword">static_cast&lt;</span>uint<span class="keyword">&gt;</span>(epoch), epochs, loss.item&lt;<span class="keywordtype">float</span>&gt;());</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;            <span class="comment">// Process this update so the user actually sees progress.</span></div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;            QCoreApplication::processEvents();</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;            batch_index++;</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;        }</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    }</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    <a class="code" href="class_network.html#ad8dd3209c836d387f5e6c762b8e7f476">network</a>-&gt;train(<span class="keyword">false</span>);</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;}</div>
<div class="ttc" id="aclass_network_html_ab8977e4e88c259ebf57040c0f16a7b36"><div class="ttname"><a href="class_network.html#ab8977e4e88c259ebf57040c0f16a7b36">Network::trainingUpdate</a></div><div class="ttdeci">void trainingUpdate(unsigned int batch, unsigned int total_batches, unsigned int epoch, unsigned int total_epochs, float latest_loss)</div><div class="ttdoc">A signal that periodically emits to showcase training progress.</div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="network_8h_source.html#l00108">DATA_PATH</a>, <a class="el" href="network_8h_source.html#l00112">network</a>, and <a class="el" href="class_network.html#ab8977e4e88c259ebf57040c0f16a7b36">trainingUpdate()</a>.</p>

<p class="reference">Referenced by <a class="el" href="main_8cpp_source.html#l00015">main()</a>, and <a class="el" href="test__network_8cpp_source.html#l00163">TestNetwork::train()</a>.</p>

</div>
</div>
<a id="ab8977e4e88c259ebf57040c0f16a7b36"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab8977e4e88c259ebf57040c0f16a7b36">&#9670;&nbsp;</a></span>trainingUpdate</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void Network::trainingUpdate </td>
          <td>(</td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>batch</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>total_batches</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>epoch</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>total_epochs</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>latest_loss</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">signal</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>A signal that periodically emits to showcase training progress. </p>
<p>Training is signalled to be complete when epoch == total_epochs. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">batch</td><td>The batch number that just completed. </td></tr>
    <tr><td class="paramname">total_batches</td><td>The approximate total batches that will be run each epoch. </td></tr>
    <tr><td class="paramname">epoch</td><td>The epoch number that just completed. </td></tr>
    <tr><td class="paramname">total_epochs</td><td>The total number of epochs to trair for. </td></tr>
    <tr><td class="paramname">latest_loss</td><td>The loss value calculated for the just completed epoch. </td></tr>
  </table>
  </dd>
</dl>

<p class="reference">Referenced by <a class="el" href="main_8cpp_source.html#l00015">main()</a>, and <a class="el" href="network_8cpp_source.html#l00053">startTraining()</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="a4c8dddada64d75c5da4df8f056124f81"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4c8dddada64d75c5da4df8f056124f81">&#9670;&nbsp;</a></span>current_index</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">size_t Network::current_index</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The index of the current image that should be displayed. </p>

<p class="definition">Definition at line <a class="el" href="network_8h_source.html#l00100">100</a> of file <a class="el" href="network_8h_source.html">network.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="network_8cpp_source.html#l00033">changeImage()</a>, <a class="el" href="network_8cpp_source.html#l00005">Network()</a>, and <a class="el" href="network_8cpp_source.html#l00108">sendImage()</a>.</p>

</div>
</div>
<a id="a0b8cef53ecb3c0d57e325e3295c35130"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0b8cef53ecb3c0d57e325e3295c35130">&#9670;&nbsp;</a></span>data</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">QScopedPointer&lt;torch::data::datasets::MNIST&gt; Network::data</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>A pointer to the loaded dataset. </p>

<p class="definition">Definition at line <a class="el" href="network_8h_source.html#l00104">104</a> of file <a class="el" href="network_8h_source.html">network.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="network_8cpp_source.html#l00033">changeImage()</a>, <a class="el" href="network_8cpp_source.html#l00005">Network()</a>, and <a class="el" href="network_8cpp_source.html#l00108">sendImage()</a>.</p>

</div>
</div>
<a id="abac93a2549bd645b36a20c1759ba3b2f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abac93a2549bd645b36a20c1759ba3b2f">&#9670;&nbsp;</a></span>DATA_PATH</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const QString Network::DATA_PATH = &quot;C:/Users/kylem/Documents/dev/src/mnist-viewer/<a class="el" href="class_network.html#a0b8cef53ecb3c0d57e325e3295c35130">data</a>&quot;</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The hard coded location of the dataset file. </p>

<p class="definition">Definition at line <a class="el" href="network_8h_source.html#l00108">108</a> of file <a class="el" href="network_8h_source.html">network.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="network_8cpp_source.html#l00005">Network()</a>, and <a class="el" href="network_8cpp_source.html#l00053">startTraining()</a>.</p>

</div>
</div>
<a id="ad8dd3209c836d387f5e6c762b8e7f476"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad8dd3209c836d387f5e6c762b8e7f476">&#9670;&nbsp;</a></span>network</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">torch::nn::Sequential Network::network</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>The MNIST network that does the prediction. </p>

<p class="definition">Definition at line <a class="el" href="network_8h_source.html#l00112">112</a> of file <a class="el" href="network_8h_source.html">network.h</a>.</p>

<p class="reference">Referenced by <a class="el" href="network_8cpp_source.html#l00005">Network()</a>, <a class="el" href="network_8cpp_source.html#l00108">sendImage()</a>, and <a class="el" href="network_8cpp_source.html#l00053">startTraining()</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>include/<a class="el" href="network_8h_source.html">network.h</a></li>
<li>src/<a class="el" href="network_8cpp_source.html">network.cpp</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="class_network.html">Network</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
